---
title: 'Limpia el request body en nodejs(express)'
# mm/dd/yyyy
date: '06-21-2022'
content: 'Manejar tus formularios sin c贸digo de terceros ya no ser谩 un dolor de cabeza'
keywords: 'Nodejs, middleware express, limpiar objetos javascript, expressjs'
---

![limpieza-middleware-propiedades-objetos-nodejs.jpeg](/limpieza-middleware-propiedades-objetos-nodejs.jpeg)

Seguramente en alguna ocasi贸n mientras desarrollabas tu api, quisiste hacer una actualizaci贸n pero no quieres que ciertos campos sean actualizado bajo ninguna circunstanc铆a, y has empezado a validar y limpiar tu body desde el controlador (aqui vamos a super que estamos usando node y express )

```js
const updateSomething = async (req, resp) => {
  const { anyProperty, ...rest } = req.body;

  // aqui actualizamos a base de datos
  const result = await udpateFunction(...rest);
};
```

### El problema ゲ

Bueno estoy seguro que no es una accion que haras en un solo controlador seguramente repetiremos esto varias veces a traves de nuestra app y como somos buenos devs no queremos repetirnos a nosotros mismo. DRY

En el ejemplo pasado tambien nos encontramos con una situaci贸n 驴Y si son varias las propiedades que queremos borrar del body?

### La soluci贸n コ

Bueno seguro te vienen soluciones a la mente pero a mi se me ocurrio extraer esa logica a un middleware que podamos usar en cualquier ruta dejame y te ense帽o como hacerlo f谩cilmente.

```js
export const sanitizeRequestBody = (properties = []) => {
  return (req, res, next) => {
    if (!req.body) {
      return res.status(400).json({
        message: 'No se ha enviado ningun body',
      });
    }

    for (let i = 0; i < properties.length; i++) {
      delete req.body[properties[i]];
    }
    next();
  };
};
```

Puedes copias y pegar sin entender que est谩 pasando, pero te contar茅 brevenemente lo que esta pasando, recibimos un array de propiedades (la key que quiere eliminar en body) y lo recorremos y por cada posici贸n aplicamos el operador delete y eso seria todo, no es para nada dificil.

驴Lo quieres ver en acci贸n? pues nada es super sencillo

```js
// importacion del modulo
import { sanitizeRequestBody } from 'middlewares'
import { updateSomething } from 'something.controllers.js'

import {Route} from 'express'
const route. = Route()

route.put(
    '/update/:id',
    [
        validateJWT,        sanitizeRequestBody(['dni', 'companyId', 'client']),
    ],
    updateSomething
);
```

Y eso fue todo.

### Algo que no quieres leer 

Si este middleware te funciono perfecto, me alegro pero antes me gustaria decirte dos cosas

- Si puedes escoger la tecnolog铆a utiliza nest js, si no puedes y usas express, usa express-validator, tienes un monton de validacion y sanitizaci贸n super util.
- Es mejor que crees un DTO para estas movidas

Y si no sabes que es un dto pues felicidades, ya tienes algo nuevo que aprender esta semana 
